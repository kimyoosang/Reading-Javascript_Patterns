# Chapter8. DOM과 브라우저 패턴

- 코어 자바스크립트가 아닌 가장 일반적인 자바스크립트 프로그램의 실행 환경인 브라우저에 특화된 여러 가지 패턴에대해 알아본다
- 브라우저 스크립팅은 사실 많은 개발자들이 자바스크립트 중에서 싫어하는 부분이기도 한데, 브라우저별로 일관성이 없는 호스트 객체와 DOM 구현들의 불편함은 클라이언트 스크립팅을 도와주는 훌륭한 패턴들을 사용한다면 이런 어려움을 덜 수 있다

## **8.1 관심사의 분리**

- 웹 애플리케이션 개발에서의 주요 관심사는 다음의 세 가지로 나누어 볼 수 있다
  - 내용
    - HTML 문서
  - 표현
    - CSS스타일: 문서가 어떻게 보여질 것인지 지정한다
  - 행동
    - 자바스크립트: 사용자 인터렉션과 문서의 동적인 변경을 처리한다
- 세 가지 관심사를 최대한 분리할수록, 좀더 광범위한 사용자 에이전트 (예를 들어 그래픽 브라우저, 텍스트만 지원하는 브라우저, 장애인을 위한 보조공학기기, 모바일 기기) 에 애플리케이션을 탑재하기가 용이해진다
- 관심사의 분리는 실무에서 다음과 같은 의미다
  1. CSS 끈 상태에서 페이지를 테스트한다. 이 상태로도 사용 가능하고 내용이 표시되며 읽을 수 있어야 한다
  2. 자바스크립트를 끈 상태에서 페이지를 테스트한다. 여전히 주 목적에 맞게 제대로 동작하고, 모든 링크가 작동하며, 홈 또한 제대로 동작하고 전송할 수 있어야 한다
  3. onclick과 같은 인라인 이벤트 핸들러 또는 인라인 style 속성은 '내용'에 속하지 않으므로 사용하지 않는다
  4. 시맨틱하고 의미에 맞는 HTML 엘리먼트를 사용한다
- '행동'에 속하는 자바스크립트는 **무간섭적**이어야 한다. 즉 자바스크립특 사용자를 방해하거나, 자바스크립트를 지원하지 않는 브라우저에서 페이지를 사용할 수 없게 만들어서는 안되며, 페이지 동작시 필수 요건이 되어서는 안된다는 뜻이다. 자바스크립트는 페이지를 향상시키기만 해야 한다
- **기능 탐지**는 브라우저간의 차이점을 우아하게 다루는 일반적인 기술 중 하나다. 사용자 에이전트를 감지해 코드를 분기하는 대신에, 사용하려는 메서드나 프로퍼티가 현재의 실행 환경에 존재하는지 확인하는 기술을 말한다. 사용자 에이전트 감지는 대체로 안티패턴이라 할 수 있다. 때로는 사용자 에이전트 감지를 쓸 수밖에 없는 경우도 있지만, 기능 탐지로 확실한 결과를 얻을 수 없거나 성능상 심각한 문제를 초래하는 경우에만 최후의 선택 사항으로 고려해야 한다

  ```javascript
  //안티패턴
  if (navigator.userAgent.indexOf("MSIE") !== 1) {
    document.attachEvent("onclick", console.log);
  }

  //더 좋은 방법
  if (document.attachEvent) {
    document.attachEvent("onclick", console.log);
  }

  //조금 더 정확한 방법
  if (typeof document.attachEvent !== "undefined") {
    document.attachEvent("onclick", console.log);
  }
  ```

- 관심사를 분리하면 개발 및 유지보수 그리고 기존의 웹애플리케이션을 업데이트하기 또한 용이해진다. 문제가 생겼을 때 어느 부분을 확인하면 되는지 알 수 있기 때문이다. 자바스크립트 오류가 발생하면, 문제를 해결하기 위해 HTML이나 CSS를 찾아볼 필요가 없다
